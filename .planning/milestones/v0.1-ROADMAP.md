# Milestone v0.1: Lint & Tooling

**Status:** ✅ SHIPPED 2026-01-21
**Phases:** 1-4
**Total Plans:** 4

## Overview

Clean up ansible-lint violations and add tooling to prevent regressions. Three phases: bulk lint fixes, validation that nothing broke, then a Claude Code hook to catch future issues. Mechanical work that clears technical debt and establishes quality gates.

## Phases

### Phase 1: Lint Cleanup

**Goal**: All playbooks pass ansible-lint with zero violations
**Depends on**: Nothing (first phase)
**Requirements**: LINT-01, LINT-02, LINT-03, LINT-04, LINT-05, LINT-06
**Plans**: 3 plans

Plans:
- [x] 01-01-PLAN.md — Fix FQCN and truthy violations across all playbooks
- [x] 01-02-PLAN.md — Add names to all plays (import_playbook directives)
- [x] 01-03-PLAN.md — Fix line-length and latest[git] violations

**Details:**
- Eliminated 677 violations across 104 YAML files
- FQCN: ansible.builtin.* for core modules, community.general.* for community
- Truthy: yes/no → true/false for all boolean fields
- Names: All import_playbook directives have descriptive names
- Line length: Shell commands wrapped with backslash continuation
- Git versions: Pinned to version: master (HEAD not recognized by ansible-lint)

### Phase 2: Validation

**Goal**: Confirm lint fixes didn't break anything
**Depends on**: Phase 1
**Requirements**: VALID-01, VALID-02
**Plans**: Ad-hoc execution (no formal plan)

**Details:**
- Ran setup-all.sh on all hosts
- desktop (local): 323 tasks OK, 0 failures
- macmini (remote): 318 tasks OK, 0 failures
- macbookair/miniserver: unreachable (offline)

### Phase 3: Tooling

**Goal**: Claude Code automatically validates YAML changes
**Depends on**: Phase 2 (want clean baseline before adding hook)
**Requirements**: TOOL-01, TOOL-02
**Plans**: Ad-hoc execution (documented in Phase 4)

**Details:**
- Hook source: tools/claude-code/hooks/ansible-lint.sh (34 lines)
- Deployment: Added to install_claude-code.yml via ansible.builtin.copy
- Deployed to: ~/.claude/hooks/ansible-lint.sh

### Phase 4: Hook Registration

**Goal**: Wire ansible-lint hook to Claude Code PostToolUse trigger
**Depends on**: Phase 3 (hook must exist before registration)
**Requirements**: TOOL-01, TOOL-02 (completing what Phase 3 started)
**Plans**: 1 plan

Plans:
- [x] 04-01-PLAN.md — Add hook registration to repo-level settings.json

**Details:**
- Registration: .claude/settings.json with PostToolUse hook (Edit|Write matcher)
- Deviation: Used settings.json (tracked) instead of settings.local.json (gitignored) per project convention

---

## Milestone Summary

**Key Decisions:**
- Use settings.json (tracked) for shared hooks, settings.local.json (gitignored) for personal overrides
- Hook invokes $HOME path for cross-machine compatibility
- Targeted lint fixes first (FQCN, truthy, name), defer risky-* and command-* violations
- version: master for git module (ansible-lint doesn't recognize HEAD)

**Issues Resolved:**
- 677 ansible-lint violations eliminated (FQCN, truthy, name[play], line-length, latest[git])
- Hook registration gap closed (Phase 4)

**Issues Deferred:**
- 267 non-targeted violations (command-instead-of-shell, risky-file-permissions, no-changed-when, etc.)
- Full CI/CD pipeline (deferred to v0.2)

**Technical Debt Incurred:**
- Phases 2 and 3 executed ad-hoc without formal PLAN/SUMMARY documentation

---

*For current project status, see .planning/PROJECT.md*
*Archived: 2026-01-21 as part of v0.1 milestone completion*
